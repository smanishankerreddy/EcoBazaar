"use strict";(self.webpackChunkecobazaar=self.webpackChunkecobazaar||[]).push([[164],{3164:(N,_,i)=>{i.r(_),i.d(_,{UserDashboardComponent:()=>S});var l=i(2881),p=i(5207),d=i(5596),u=i(8834),h=i(9980),c=i(3662),g=i(6704),f=i(6863),b=i(9417),C=i(6042),t=i(1360),E=i(5567),v=i(4506);function D(e,o){1&e&&(t.j41(0,"div",8),t.EFF(1,"Loading your cart..."),t.k0s())}function x(e,o){if(1&e&&(t.j41(0,"div",9),t.EFF(1),t.k0s()),2&e){const a=t.XpG();t.R7$(),t.SpI(" ",a.errorMessage," ")}}function F(e,o){1&e&&(t.j41(0,"th",25),t.EFF(1,"Product"),t.k0s())}function M(e,o){if(1&e&&(t.j41(0,"td",26)(1,"strong"),t.EFF(2),t.k0s()()),2&e){const a=o.$implicit;t.R7$(2),t.JRh(a.productName)}}function P(e,o){1&e&&(t.j41(0,"th",25),t.EFF(1,"Quantity"),t.k0s())}function O(e,o){if(1&e){const a=t.RV6();t.j41(0,"td",26)(1,"div",27)(2,"button",28),t.bIt("click",function(){const n=t.eBV(a).$implicit,s=t.XpG(2);return t.Njj(s.updateQuantity(n.id,n.quantity-1))}),t.j41(3,"mat-icon"),t.EFF(4,"remove"),t.k0s()(),t.j41(5,"input",29),t.bIt("change",function(n){const s=t.eBV(a).$implicit,m=t.XpG(2);return t.Njj(m.updateQuantity(s.id,n.target.value))}),t.k0s(),t.j41(6,"button",28),t.bIt("click",function(){const n=t.eBV(a).$implicit,s=t.XpG(2);return t.Njj(s.updateQuantity(n.id,n.quantity+1))}),t.j41(7,"mat-icon"),t.EFF(8,"add"),t.k0s()()()()}if(2&e){const a=o.$implicit;t.R7$(5),t.Y8G("value",a.quantity)}}function y(e,o){1&e&&(t.j41(0,"th",25),t.EFF(1,"Price"),t.k0s())}function j(e,o){if(1&e&&(t.j41(0,"td",26),t.EFF(1),t.k0s()),2&e){const a=o.$implicit;t.R7$(),t.SpI("$",a.price.toFixed(2),"")}}function T(e,o){1&e&&(t.j41(0,"th",25),t.EFF(1,"CO\u2082 (kg)"),t.k0s())}function k(e,o){if(1&e&&(t.j41(0,"td",26)(1,"span",30),t.EFF(2),t.k0s()()),2&e){const a=o.$implicit;t.R7$(2),t.JRh(a.carbonImpact.toFixed(2))}}function U(e,o){1&e&&(t.j41(0,"th",25),t.EFF(1,"Actions"),t.k0s())}function R(e,o){if(1&e){const a=t.RV6();t.j41(0,"td",26)(1,"button",31),t.bIt("click",function(){const n=t.eBV(a).$implicit,s=t.XpG(2);return t.Njj(s.removeItem(n.id))}),t.j41(2,"mat-icon"),t.EFF(3,"delete"),t.k0s()()()}}function I(e,o){1&e&&t.nrm(0,"tr",32)}function L(e,o){1&e&&t.nrm(0,"tr",33)}function $(e,o){if(1&e&&(t.j41(0,"div")(1,"table",10),t.qex(2,11),t.DNE(3,F,2,0,"th",12)(4,M,3,1,"td",13),t.bVm(),t.qex(5,14),t.DNE(6,P,2,0,"th",12)(7,O,9,1,"td",13),t.bVm(),t.qex(8,15),t.DNE(9,y,2,0,"th",12)(10,j,2,1,"td",13),t.bVm(),t.qex(11,16),t.DNE(12,T,2,0,"th",12)(13,k,3,1,"td",13),t.bVm(),t.qex(14,17),t.DNE(15,U,2,0,"th",12)(16,R,4,0,"td",13),t.bVm(),t.DNE(17,I,1,0,"tr",18)(18,L,1,0,"tr",19),t.k0s(),t.j41(19,"div",20)(20,"div",21)(21,"span"),t.EFF(22,"Total Price"),t.k0s(),t.j41(23,"strong"),t.EFF(24),t.k0s()(),t.j41(25,"div",21)(26,"span"),t.EFF(27,"Total Carbon"),t.k0s(),t.j41(28,"strong",22),t.EFF(29),t.k0s()()(),t.j41(30,"div",23)(31,"button",24),t.EFF(32," Open Full Cart / Checkout "),t.k0s()()()),2&e){const a=t.XpG();t.R7$(),t.Y8G("dataSource",a.cart.items),t.R7$(16),t.Y8G("matHeaderRowDef",a.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",a.displayedColumns),t.R7$(6),t.SpI("$",a.getTotalPrice().toFixed(2),""),t.R7$(5),t.SpI("",a.getTotalCarbon().toFixed(2)," kg CO\u2082")}}function B(e,o){1&e&&(t.j41(0,"div",34)(1,"mat-icon"),t.EFF(2,"shopping_cart"),t.k0s(),t.j41(3,"h3"),t.EFF(4,"Your cart is empty"),t.k0s(),t.j41(5,"p"),t.EFF(6,"Add products to your cart to see them here."),t.k0s(),t.j41(7,"button",35),t.EFF(8,"Browse Products"),t.k0s()())}let S=(()=>{class e{constructor(a,r){this.cartService=a,this.notificationService=r,this.cart=null,this.displayedColumns=["product","quantity","price","carbon","actions"],this.isLoading=!1,this.errorMessage=""}ngOnInit(){this.loadCart()}loadCart(){this.isLoading=!0,this.errorMessage="",this.cartService.getCart().subscribe({next:a=>{this.cart=a,this.isLoading=!1},error:a=>{console.error("Error loading cart:",a),this.errorMessage="Failed to load your cart",this.isLoading=!1}})}updateQuantity(a,r){const n=Number(r);if(Number.isFinite(n)){if(n<1)return void this.removeItem(a);this.cartService.updateItem(a,n).subscribe({next:s=>{this.cart=s,this.notificationService.showSuccess("Cart updated")},error:s=>{console.error("Error updating item:",s),this.notificationService.showError(s.error?.message||"Failed to update item")}})}}removeItem(a){this.cartService.removeItem(a).subscribe({next:r=>{this.cart=r,this.notificationService.showSuccess("Item removed")},error:r=>{console.error("Error removing item:",r),this.notificationService.showError(r.error?.message||"Failed to remove item")}})}getTotalPrice(){return this.cart?.totalPrice||0}getTotalCarbon(){return this.cart?.totalCarbon||0}static{this.\u0275fac=function(r){return new(r||e)(t.rXU(C.m),t.rXU(E.J))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-user-dashboard"]],decls:21,vars:4,consts:[[1,"dashboard-container"],[1,"dashboard-header"],["mat-stroked-button","","color","primary","routerLink","/products"],[1,"dashboard-card"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],[4,"ngIf"],["class","empty",4,"ngIf"],[1,"loading"],[1,"error-message"],["mat-table","",1,"cart-table",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","quantity"],["matColumnDef","price"],["matColumnDef","carbon"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"summary"],[1,"summary-row"],[1,"carbon-total"],[1,"actions"],["mat-raised-button","","color","primary","routerLink","/cart"],["mat-header-cell",""],["mat-cell",""],[1,"quantity-controls"],["mat-icon-button","",3,"click"],["type","number","min","1",1,"quantity-input",3,"change","value"],[1,"carbon-badge"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"empty"],["mat-raised-button","","color","primary","routerLink","/products"]],template:function(r,n){1&r&&(t.j41(0,"div",0)(1,"div",1)(2,"h1")(3,"mat-icon"),t.EFF(4,"dashboard"),t.k0s(),t.EFF(5," My Dashboard "),t.k0s(),t.j41(6,"button",2)(7,"mat-icon"),t.EFF(8,"store"),t.k0s(),t.EFF(9," Continue Shopping "),t.k0s()(),t.j41(10,"mat-card",3)(11,"mat-card-header")(12,"mat-card-title"),t.EFF(13,"My Cart"),t.k0s(),t.j41(14,"mat-card-subtitle"),t.EFF(15,"Update quantities or remove items"),t.k0s()(),t.j41(16,"mat-card-content"),t.DNE(17,D,2,0,"div",4)(18,x,2,1,"div",5)(19,$,33,5,"div",6)(20,B,9,0,"div",7),t.k0s()()()),2&r&&(t.R7$(17),t.Y8G("ngIf",n.isLoading),t.R7$(),t.Y8G("ngIf",n.errorMessage),t.R7$(),t.Y8G("ngIf",!n.isLoading&&n.cart&&n.cart.items&&n.cart.items.length>0),t.R7$(),t.Y8G("ngIf",!(n.isLoading||n.cart&&n.cart.items&&0!==n.cart.items.length)))},dependencies:[l.MD,l.bT,p.iI,p.Wk,d.Hu,d.RN,d.m2,d.MM,d.Lc,d.dh,u.Hl,u.$z,v.M,h.m_,h.An,c.tP,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,g.M,f.fS,b.YN],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto;min-height:calc(100vh - 64px)}.dashboard-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:20px}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;font-size:28px;color:#2c3e50}.dashboard-card[_ngcontent-%COMP%]{background:#fff}.cart-table[_ngcontent-%COMP%]{width:100%;margin-top:12px}.quantity-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.quantity-input[_ngcontent-%COMP%]{width:70px;text-align:center;padding:4px;border:1px solid #ddd;border-radius:6px}.carbon-badge[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:4px 10px;border-radius:999px;font-size:12px}.summary[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:1px solid #eee}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:6px 0;font-size:16px}.carbon-total[_ngcontent-%COMP%]{color:#4caf50}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:16px}.loading[_ngcontent-%COMP%]{padding:24px;text-align:center;color:#666}.error-message[_ngcontent-%COMP%]{color:#f44336;background:#ffebee;padding:12px;border-radius:8px;margin:12px 0}.empty[_ngcontent-%COMP%]{text-align:center;padding:48px 16px;color:#666}.empty[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#ccc;margin-bottom:12px}@media (max-width: 768px){.dashboard-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"]})}}return e})()}}]);