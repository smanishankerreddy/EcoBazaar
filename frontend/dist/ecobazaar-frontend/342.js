"use strict";(self.webpackChunkecobazaar=self.webpackChunkecobazaar||[]).push([[342],{4342:(X,m,a)=>{a.r(m),a.d(m,{CartComponent:()=>Y});var l=a(2881),p=a(5207),d=a(5596),u=a(8834),g=a(9980),s=a(3662),h=a(6704),f=a(6863),C=a(9417),v=a(6042),_=a(5312),t=a(1360),x=a(8989);let b=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${_.c.apiUrl}/orders`}createOrder(e){return this.http.post(this.apiUrl,e)}getOrders(){return this.http.get(this.apiUrl)}getOrderById(e){return this.http.get(`${this.apiUrl}/${e}`)}static{this.\u0275fac=function(n){return new(n||r)(t.KVO(x.Qq))}}static{this.\u0275prov=t.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var F=a(2852),y=a(5567),j=a(4506);function E(r,i){1&r&&(t.j41(0,"div",6),t.EFF(1," Loading cart... "),t.k0s())}function k(r,i){if(1&r&&(t.j41(0,"div",7),t.EFF(1),t.k0s()),2&r){const e=t.XpG();t.R7$(),t.SpI(" ",e.errorMessage," ")}}function M(r,i){1&r&&(t.j41(0,"th",25),t.EFF(1,"Product"),t.k0s())}function S(r,i){if(1&r&&(t.j41(0,"td",26)(1,"div",27)(2,"strong"),t.EFF(3),t.k0s()()()),2&r){const e=i.$implicit;t.R7$(3),t.JRh(e.productName)}}function T(r,i){1&r&&(t.j41(0,"th",25),t.EFF(1,"Quantity"),t.k0s())}function $(r,i){if(1&r){const e=t.RV6();t.j41(0,"td",26)(1,"div",28)(2,"button",29),t.bIt("click",function(){const o=t.eBV(e).$implicit,c=t.XpG(2);return t.Njj(c.updateQuantity(o.id,o.quantity-1))}),t.j41(3,"mat-icon"),t.EFF(4,"remove"),t.k0s()(),t.j41(5,"input",30),t.bIt("change",function(o){const c=t.eBV(e).$implicit,B=t.XpG(2);return t.Njj(B.updateQuantity(c.id,o.target.value))}),t.k0s(),t.j41(6,"button",29),t.bIt("click",function(){const o=t.eBV(e).$implicit,c=t.XpG(2);return t.Njj(c.updateQuantity(o.id,o.quantity+1))}),t.j41(7,"mat-icon"),t.EFF(8,"add"),t.k0s()()()()}if(2&r){const e=i.$implicit;t.R7$(5),t.Y8G("value",e.quantity)}}function I(r,i){1&r&&(t.j41(0,"th",25),t.EFF(1,"Price"),t.k0s())}function O(r,i){if(1&r&&(t.j41(0,"td",26),t.EFF(1),t.k0s()),2&r){const e=i.$implicit;t.R7$(),t.SpI("$",e.price.toFixed(2),"")}}function P(r,i){1&r&&(t.j41(0,"th",25),t.EFF(1,"CO\u2082 (kg)"),t.k0s())}function R(r,i){if(1&r&&(t.j41(0,"td",26)(1,"span",31),t.EFF(2),t.k0s()()),2&r){const e=i.$implicit;t.R7$(2),t.JRh(e.carbonImpact.toFixed(2))}}function D(r,i){1&r&&(t.j41(0,"th",25),t.EFF(1,"Actions"),t.k0s())}function w(r,i){if(1&r){const e=t.RV6();t.j41(0,"td",26)(1,"button",32),t.bIt("click",function(){const o=t.eBV(e).$implicit,c=t.XpG(2);return t.Njj(c.removeItem(o.id))}),t.j41(2,"mat-icon"),t.EFF(3,"delete"),t.k0s()()()}}function G(r,i){1&r&&t.nrm(0,"tr",33)}function N(r,i){1&r&&t.nrm(0,"tr",34)}function V(r,i){if(1&r){const e=t.RV6();t.j41(0,"div")(1,"table",8),t.qex(2,9),t.DNE(3,M,2,0,"th",10)(4,S,4,1,"td",11),t.bVm(),t.qex(5,12),t.DNE(6,T,2,0,"th",10)(7,$,9,1,"td",11),t.bVm(),t.qex(8,13),t.DNE(9,I,2,0,"th",10)(10,O,2,1,"td",11),t.bVm(),t.qex(11,14),t.DNE(12,P,2,0,"th",10)(13,R,3,1,"td",11),t.bVm(),t.qex(14,15),t.DNE(15,D,2,0,"th",10)(16,w,4,0,"td",11),t.bVm(),t.DNE(17,G,1,0,"tr",16)(18,N,1,0,"tr",17),t.k0s(),t.j41(19,"div",18)(20,"div",19)(21,"span"),t.EFF(22,"Total Price:"),t.k0s(),t.j41(23,"strong"),t.EFF(24),t.k0s()(),t.j41(25,"div",20)(26,"span"),t.EFF(27,"Total Carbon Footprint:"),t.k0s(),t.j41(28,"strong",21),t.EFF(29),t.k0s()()(),t.j41(30,"div",22)(31,"button",23),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.clearCart())}),t.EFF(32," Clear Cart "),t.k0s(),t.j41(33,"button",24),t.bIt("click",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.checkout())}),t.EFF(34," Checkout "),t.k0s()()()}if(2&r){const e=t.XpG();t.R7$(),t.Y8G("dataSource",e.cart.items),t.R7$(16),t.Y8G("matHeaderRowDef",e.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",e.displayedColumns),t.R7$(6),t.SpI("$",e.getTotalPrice().toFixed(2),""),t.R7$(5),t.SpI("",e.getTotalCarbon().toFixed(2)," kg CO\u2082"),t.R7$(4),t.Y8G("disabled",e.isLoading)}}function L(r,i){1&r&&(t.j41(0,"div",35)(1,"mat-icon"),t.EFF(2,"shopping_cart"),t.k0s(),t.j41(3,"h3"),t.EFF(4,"Your cart is empty"),t.k0s(),t.j41(5,"p"),t.EFF(6,"Start shopping to add items to your cart"),t.k0s(),t.j41(7,"button",36),t.EFF(8," Browse Products "),t.k0s()())}let Y=(()=>{class r{constructor(e,n,o,c){this.cartService=e,this.orderService=n,this.router=o,this.notificationService=c,this.cart=null,this.displayedColumns=["product","quantity","price","carbon","actions"],this.isLoading=!1,this.errorMessage=""}ngOnInit(){this.loadCart()}loadCart(){this.isLoading=!0,this.cartService.getCart().subscribe({next:e=>{this.cart=e,this.isLoading=!1},error:e=>{console.error("Error loading cart:",e),this.errorMessage="Failed to load cart",this.isLoading=!1}})}updateQuantity(e,n){n<1?this.removeItem(e):this.cartService.updateItem(e,n).subscribe({next:o=>{this.cart=o,this.notificationService.showSuccess("Cart updated successfully!")},error:o=>{console.error("Error updating item:",o);const c=o.error?.message||"Failed to update item";this.errorMessage=c,this.notificationService.showError(c)}})}removeItem(e){this.cartService.removeItem(e).subscribe({next:n=>{this.cart=n,this.notificationService.showSuccess("Item removed from cart")},error:n=>{console.error("Error removing item:",n);const o=n.error?.message||"Failed to remove item";this.errorMessage=o,this.notificationService.showError(o)}})}clearCart(){confirm("Are you sure you want to clear your cart?")&&this.cartService.clearCart().subscribe({next:e=>{this.cart=e,this.notificationService.showSuccess("Cart cleared successfully!")},error:e=>{console.error("Error clearing cart:",e);const n=e.error?.message||"Failed to clear cart";this.errorMessage=n,this.notificationService.showError(n)}})}checkout(){if(!this.cart||!this.cart.items||0===this.cart.items.length)return this.errorMessage="Cart is empty",void this.notificationService.showWarning("Your cart is empty. Add some products first!");this.isLoading=!0,this.orderService.createOrder({}).subscribe({next:e=>{this.notificationService.showSuccess("Order placed successfully! Thank you for shopping with EcoBazaar."),this.router.navigate(["/orders",e.id])},error:e=>{console.error("Error creating order:",e);const n=e.error?.message||"Failed to create order";this.errorMessage=n,this.notificationService.showError(n),this.isLoading=!1}})}getTotalPrice(){return this.cart?.totalPrice||0}getTotalCarbon(){return this.cart?.totalCarbon||0}static{this.\u0275fac=function(n){return new(n||r)(t.rXU(v.m),t.rXU(b),t.rXU(F.Ix),t.rXU(y.J))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-cart"]],decls:10,vars:4,consts:[[1,"cart-container"],[1,"cart-card"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],[4,"ngIf"],["class","empty-cart",4,"ngIf"],[1,"loading"],[1,"error-message"],["mat-table","",1,"cart-table",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","quantity"],["matColumnDef","price"],["matColumnDef","carbon"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"cart-summary"],[1,"summary-row"],[1,"summary-row","carbon-row"],[1,"carbon-total"],[1,"cart-actions"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],[1,"product-info"],[1,"quantity-controls"],["mat-icon-button","",3,"click"],["type","number","min","1",1,"quantity-input",3,"change","value"],[1,"carbon-badge"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"empty-cart"],["mat-raised-button","","color","primary","routerLink","/products"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),t.EFF(4,"Shopping Cart"),t.k0s()(),t.j41(5,"mat-card-content"),t.DNE(6,E,2,0,"div",2)(7,k,2,1,"div",3)(8,V,35,6,"div",4)(9,L,9,0,"div",5),t.k0s()()()),2&n&&(t.R7$(6),t.Y8G("ngIf",o.isLoading),t.R7$(),t.Y8G("ngIf",o.errorMessage),t.R7$(),t.Y8G("ngIf",!o.isLoading&&o.cart&&o.cart.items&&o.cart.items.length>0),t.R7$(),t.Y8G("ngIf",!(o.isLoading||o.cart&&o.cart.items&&0!==o.cart.items.length)))},dependencies:[l.MD,l.bT,p.iI,p.Wk,d.Hu,d.RN,d.m2,d.MM,d.dh,u.Hl,u.$z,j.M,g.m_,g.An,s.tP,s.Zl,s.tL,s.ji,s.cC,s.YV,s.iL,s.KS,s.$R,s.YZ,s.NB,h.M,f.fS,C.YN],styles:[".cart-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto;min-height:calc(100vh - 64px)}.cart-card[_ngcontent-%COMP%]{width:100%;background:#fff}.cart-table[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}.product-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.quantity-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.quantity-input[_ngcontent-%COMP%]{width:60px;text-align:center;padding:4px;border:1px solid #ddd;border-radius:4px}.carbon-badge[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px}.cart-summary[_ngcontent-%COMP%]{border-top:2px solid #eee;padding-top:20px;margin-top:20px}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;font-size:16px}.carbon-row[_ngcontent-%COMP%]{border-top:1px solid #eee;margin-top:8px;padding-top:8px}.carbon-total[_ngcontent-%COMP%]{color:#4caf50;font-size:18px}.cart-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:20px}.empty-cart[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#666}.empty-cart[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:80px;width:80px;height:80px;color:#ccc;margin-bottom:20px}.empty-cart[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:16px 0;color:#333}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.error-message[_ngcontent-%COMP%]{color:#f44336;background-color:#ffebee;padding:12px;border-radius:4px;margin-bottom:16px}"]})}}return r})()}}]);