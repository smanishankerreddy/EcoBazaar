{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormBuilder, ReactiveFormsModule, Validators } from '@angular/forms';\nimport { MatCardModule } from '@angular/material/card';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { UserService } from '../../core/services/user.service';\nimport { AuthService } from '../../core/services/auth.service';\nimport { NotificationService } from '../../core/services/notification.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../core/services/user.service\";\nimport * as i3 from \"../../core/services/auth.service\";\nimport * as i4 from \"../../core/services/notification.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/card\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/input\";\nimport * as i9 from \"@angular/material/button\";\nimport * as i10 from \"@angular/material/icon\";\nfunction ProfileComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵtext(1, \" Loading profile... \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.errorMessage, \" \");\n  }\n}\nfunction ProfileComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.successMessage, \" \");\n  }\n}\nfunction ProfileComponent_form_11_mat_error_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1, \" Name is required \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileComponent_form_11_button_37_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 22);\n    i0.ɵɵlistener(\"click\", function ProfileComponent_form_11_button_37_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.toggleEdit());\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" Edit Profile \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProfileComponent_form_11_div_38_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 23)(1, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function ProfileComponent_form_11_div_38_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.toggleEdit());\n    });\n    i0.ɵɵtext(2, \"Cancel\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function ProfileComponent_form_11_div_38_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.saveProfile());\n    });\n    i0.ɵɵelementStart(4, \"mat-icon\");\n    i0.ɵɵtext(5, \"save\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.isLoading || ctx_r0.profileForm.invalid);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.isLoading ? \"Saving...\" : \"Save Changes\", \" \");\n  }\n}\nfunction ProfileComponent_form_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"form\", 9)(1, \"div\", 10)(2, \"h3\");\n    i0.ɵɵtext(3, \"Personal Information\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-form-field\", 11)(5, \"mat-label\");\n    i0.ɵɵtext(6, \"Full Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(7, \"input\", 12);\n    i0.ɵɵtemplate(8, ProfileComponent_form_11_mat_error_8_Template, 2, 0, \"mat-error\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"mat-form-field\", 11)(10, \"mat-label\");\n    i0.ɵɵtext(11, \"Email\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"input\", 14);\n    i0.ɵɵelementStart(13, \"mat-hint\");\n    i0.ɵɵtext(14, \"Email cannot be changed\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"mat-form-field\", 11)(16, \"mat-label\");\n    i0.ɵɵtext(17, \"Phone\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(18, \"input\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"mat-form-field\", 11)(20, \"mat-label\");\n    i0.ɵɵtext(21, \"Address\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(22, \"textarea\", 16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 10)(24, \"h3\");\n    i0.ɵɵtext(25, \"Account Information\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"mat-form-field\", 11)(27, \"mat-label\");\n    i0.ɵɵtext(28, \"Role\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(29, \"input\", 17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"mat-form-field\", 11)(31, \"mat-label\");\n    i0.ɵɵtext(32, \"Eco Score\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(33, \"input\", 18);\n    i0.ɵɵelementStart(34, \"mat-hint\");\n    i0.ɵɵtext(35, \"Your sustainability score based on purchases\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(36, \"div\", 19);\n    i0.ɵɵtemplate(37, ProfileComponent_form_11_button_37_Template, 4, 0, \"button\", 20)(38, ProfileComponent_form_11_div_38_Template, 7, 2, \"div\", 21);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    let tmp_2_0;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.profileForm);\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"ngIf\", (tmp_2_0 = ctx_r0.profileForm.get(\"name\")) == null ? null : tmp_2_0.hasError(\"required\"));\n    i0.ɵɵadvance(29);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.isEditing);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isEditing);\n  }\n}\nexport let ProfileComponent = /*#__PURE__*/(() => {\n  class ProfileComponent {\n    constructor(fb, userService, authService, notificationService) {\n      this.fb = fb;\n      this.userService = userService;\n      this.authService = authService;\n      this.notificationService = notificationService;\n      this.user = null;\n      this.isLoading = false;\n      this.isEditing = false;\n      this.successMessage = '';\n      this.errorMessage = '';\n      this.profileForm = this.fb.group({\n        name: ['', [Validators.required]],\n        email: [{\n          value: '',\n          disabled: true\n        }],\n        phone: [''],\n        address: [''],\n        role: [{\n          value: '',\n          disabled: true\n        }],\n        ecoScore: [{\n          value: 0,\n          disabled: true\n        }]\n      });\n    }\n    ngOnInit() {\n      this.loadProfile();\n    }\n    loadProfile() {\n      this.isLoading = true;\n      this.userService.getCurrentUser().subscribe({\n        next: data => {\n          this.user = data;\n          this.profileForm.patchValue({\n            name: data.name,\n            email: data.email,\n            phone: data.phone || '',\n            address: data.address || '',\n            role: data.role,\n            ecoScore: data.ecoScore || 0\n          });\n          this.isLoading = false;\n        },\n        error: error => {\n          console.error('Error loading profile:', error);\n          this.errorMessage = 'Failed to load profile';\n          this.isLoading = false;\n        }\n      });\n    }\n    toggleEdit() {\n      this.isEditing = !this.isEditing;\n      if (this.isEditing) {\n        this.profileForm.get('name')?.enable();\n        this.profileForm.get('phone')?.enable();\n        this.profileForm.get('address')?.enable();\n      } else {\n        this.profileForm.get('name')?.disable();\n        this.profileForm.get('phone')?.disable();\n        this.profileForm.get('address')?.disable();\n        this.loadProfile(); // Reload to reset changes\n      }\n    }\n    saveProfile() {\n      if (this.profileForm.valid) {\n        this.isLoading = true;\n        this.successMessage = '';\n        this.errorMessage = '';\n        const updateData = {\n          name: this.profileForm.value.name,\n          phone: this.profileForm.value.phone,\n          address: this.profileForm.value.address\n        };\n        this.userService.updateProfile(updateData).subscribe({\n          next: data => {\n            this.user = data;\n            this.successMessage = 'Profile updated successfully!';\n            this.notificationService.showSuccess('Profile updated successfully!');\n            this.isEditing = false;\n            this.profileForm.get('name')?.disable();\n            this.profileForm.get('phone')?.disable();\n            this.profileForm.get('address')?.disable();\n            this.isLoading = false;\n            // Update localStorage\n            if (data.name) {\n              localStorage.setItem('name', data.name);\n            }\n          },\n          error: error => {\n            console.error('Error updating profile:', error);\n            const errorMsg = error.error?.message || 'Failed to update profile';\n            this.errorMessage = errorMsg;\n            this.notificationService.showError(errorMsg);\n            this.isLoading = false;\n          }\n        });\n      }\n    }\n    getRoleLabel(role) {\n      const roleMap = {\n        'USER': 'User',\n        'SELLER': 'Seller',\n        'ADMIN': 'Admin'\n      };\n      return roleMap[role] || role;\n    }\n    static {\n      this.ɵfac = function ProfileComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || ProfileComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i3.AuthService), i0.ɵɵdirectiveInject(i4.NotificationService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ProfileComponent,\n        selectors: [[\"app-profile\"]],\n        decls: 12,\n        vars: 4,\n        consts: [[1, \"profile-container\"], [1, \"profile-card\"], [\"class\", \"loading\", 4, \"ngIf\"], [\"class\", \"error-message\", 4, \"ngIf\"], [\"class\", \"success-message\", 4, \"ngIf\"], [3, \"formGroup\", 4, \"ngIf\"], [1, \"loading\"], [1, \"error-message\"], [1, \"success-message\"], [3, \"formGroup\"], [1, \"profile-section\"], [\"appearance\", \"outline\", 1, \"full-width\"], [\"matInput\", \"\", \"formControlName\", \"name\", \"required\", \"\"], [4, \"ngIf\"], [\"matInput\", \"\", \"formControlName\", \"email\", \"readonly\", \"\"], [\"matInput\", \"\", \"formControlName\", \"phone\"], [\"matInput\", \"\", \"formControlName\", \"address\", \"rows\", \"3\"], [\"matInput\", \"\", \"formControlName\", \"role\", \"readonly\", \"\"], [\"matInput\", \"\", \"formControlName\", \"ecoScore\", \"readonly\", \"\"], [1, \"profile-actions\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"edit-actions\", 4, \"ngIf\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [1, \"edit-actions\"], [\"mat-button\", \"\", 3, \"click\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\", \"disabled\"]],\n        template: function ProfileComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"mat-card\", 1)(2, \"mat-card-header\")(3, \"mat-card-title\")(4, \"mat-icon\");\n            i0.ɵɵtext(5, \"person\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(6, \" My Profile \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(7, \"mat-card-content\");\n            i0.ɵɵtemplate(8, ProfileComponent_div_8_Template, 2, 0, \"div\", 2)(9, ProfileComponent_div_9_Template, 2, 1, \"div\", 3)(10, ProfileComponent_div_10_Template, 2, 1, \"div\", 4)(11, ProfileComponent_form_11_Template, 39, 4, \"form\", 5);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading && !ctx.user);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.successMessage);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.user);\n          }\n        },\n        dependencies: [CommonModule, i5.NgIf, ReactiveFormsModule, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i1.FormGroupDirective, i1.FormControlName, MatCardModule, i6.MatCard, i6.MatCardContent, i6.MatCardHeader, i6.MatCardTitle, MatFormFieldModule, i7.MatFormField, i7.MatLabel, i7.MatHint, i7.MatError, MatInputModule, i8.MatInput, MatButtonModule, i9.MatButton, MatIconModule, i10.MatIcon],\n        styles: [\".profile-container[_ngcontent-%COMP%]{padding:24px;max-width:900px;margin:0 auto;min-height:calc(100vh - 64px)}.profile-card[_ngcontent-%COMP%]{width:100%;background:#fff}mat-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:24px}mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:24px}.profile-section[_ngcontent-%COMP%]{margin-bottom:32px}.profile-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:16px;color:#333;font-size:18px;border-bottom:2px solid #4caf50;padding-bottom:8px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.profile-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:24px;padding-top:24px;border-top:1px solid #eee}.edit-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.error-message[_ngcontent-%COMP%]{color:#f44336;background-color:#ffebee;padding:12px;border-radius:4px;margin-bottom:16px}.success-message[_ngcontent-%COMP%]{color:#4caf50;background-color:#e8f5e9;padding:12px;border-radius:4px;margin-bottom:16px}\"]\n      });\n    }\n  }\n  return ProfileComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}