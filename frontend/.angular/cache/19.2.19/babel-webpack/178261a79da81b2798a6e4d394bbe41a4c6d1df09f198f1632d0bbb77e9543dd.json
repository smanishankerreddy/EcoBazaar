{"ast":null,"code":"import { inject } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AuthService } from '../services/auth.service';\nexport const roleGuard = route => {\n  const authService = inject(AuthService);\n  const router = inject(Router);\n  if (!authService.isLoggedIn()) {\n    router.navigate(['/auth/login']);\n    return false;\n  }\n  const expectedRole = route.data['role'];\n  if (!expectedRole) {\n    return true; // No role requirement\n  }\n  const userRole = authService.getUserRole();\n  // ADMIN can access everything\n  if (userRole === 'ADMIN') {\n    return true;\n  }\n  // Check if user has the required role\n  if (userRole === expectedRole) {\n    return true;\n  } else {\n    // Redirect based on user role\n    if (userRole === 'SELLER') {\n      router.navigate(['/seller']);\n    } else if (userRole === 'USER') {\n      router.navigate(['/products']);\n    } else {\n      router.navigate(['/products']);\n    }\n    return false;\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}